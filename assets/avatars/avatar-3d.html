<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avatar 3D - EstampAI</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }
        
        #avatar-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        #controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        .control-group input, .control-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .control-group button {
            background: #FF9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .control-group button:hover {
            background: #e68a00;
        }
        
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 200;
        }
    </style>
</head>
<body>
    <div id="avatar-container">
        <div id="loading">Carregando Avatar 3D...</div>
        
        <div id="controls">
            <div class="control-group">
                <label>Estilo da Estampa:</label>
                <select id="stampStyle">
                    <option value="geometrico">Geométrico</option>
                    <option value="organico">Orgânico</option>
                    <option value="abstrato">Abstrato</option>
                    <option value="figurativo">Figurativo</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>Cor Primária:</label>
                <input type="color" id="primaryColor" value="#1A237E">
            </div>
            
            <div class="control-group">
                <label>Cor Secundária:</label>
                <input type="color" id="secondaryColor" value="#FF9800">
            </div>
            
            <div class="control-group">
                <label>Intensidade da Estampa:</label>
                <input type="range" id="stampIntensity" min="0" max="1" step="0.1" value="0.8">
            </div>
            
            <div class="control-group">
                <button onclick="updateStamp()">Atualizar Estampa</button>
            </div>
            
            <div class="control-group">
                <button onclick="resetAvatar()">Reset Avatar</button>
            </div>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <script>
        // Variáveis globais
        let scene, camera, renderer, controls;
        let avatar, shirt, stampMaterial;
        let stampTexture;
        
        // Inicialização
        init();
        animate();
        
        function init() {
            // Cena
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f0f0);
            
            // Câmera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.getElementById('avatar-container').appendChild(renderer.domElement);
            
            // Controles
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // Luzes
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            // Criar avatar
            createAvatar();
            
            // Esconder loading
            document.getElementById('loading').style.display = 'none';
            
            // Event listeners
            window.addEventListener('resize', onWindowResize);
        }
        
        function createAvatar() {
            // Grupo do avatar
            avatar = new THREE.Group();
            
            // Cabeça
            const headGeometry = new THREE.SphereGeometry(0.8, 32, 32);
            const headMaterial = new THREE.MeshLambertMaterial({ 
                color: 0xfdbcb4,
                transparent: true,
                opacity: 0.9
            });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 1.5;
            head.castShadow = true;
            avatar.add(head);
            
            // Corpo
            const bodyGeometry = new THREE.CylinderGeometry(0.6, 0.8, 1.5, 32);
            const bodyMaterial = new THREE.MeshLambertMaterial({ color: 0x2c3e50 });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 0.3;
            body.castShadow = true;
            avatar.add(body);
            
            // Camiseta
            const shirtGeometry = new THREE.CylinderGeometry(0.7, 0.9, 1.3, 32);
            stampMaterial = new THREE.MeshLambertMaterial({ 
                color: 0xffffff,
                transparent: true,
                opacity: 0.9
            });
            shirt = new THREE.Mesh(shirtGeometry, stampMaterial);
            shirt.position.y = 0.4;
            shirt.castShadow = true;
            avatar.add(shirt);
            
            // Braços
            const armGeometry = new THREE.CylinderGeometry(0.15, 0.2, 1, 16);
            const armMaterial = new THREE.MeshLambertMaterial({ color: 0xfdbcb4 });
            
            const leftArm = new THREE.Mesh(armGeometry, armMaterial);
            leftArm.position.set(-0.8, 0.2, 0);
            leftArm.rotation.z = 0.3;
            leftArm.castShadow = true;
            avatar.add(leftArm);
            
            const rightArm = new THREE.Mesh(armGeometry, armMaterial);
            rightArm.position.set(0.8, 0.2, 0);
            rightArm.rotation.z = -0.3;
            rightArm.castShadow = true;
            avatar.add(rightArm);
            
            // Pernas
            const legGeometry = new THREE.CylinderGeometry(0.2, 0.25, 1.2, 16);
            const legMaterial = new THREE.MeshLambertMaterial({ color: 0x2c3e50 });
            
            const leftLeg = new THREE.Mesh(legGeometry, legMaterial);
            leftLeg.position.set(-0.3, -1.1, 0);
            leftLeg.castShadow = true;
            avatar.add(leftLeg);
            
            const rightLeg = new THREE.Mesh(legGeometry, legMaterial);
            rightLeg.position.set(0.3, -1.1, 0);
            rightLeg.castShadow = true;
            avatar.add(rightLeg);
            
            // Pés
            const footGeometry = new THREE.BoxGeometry(0.4, 0.2, 0.8);
            const footMaterial = new THREE.MeshLambertMaterial({ color: 0x34495e });
            
            const leftFoot = new THREE.Mesh(footGeometry, footMaterial);
            leftFoot.position.set(-0.3, -1.8, 0.2);
            leftFoot.castShadow = true;
            avatar.add(leftFoot);
            
            const rightFoot = new THREE.Mesh(footGeometry, footMaterial);
            rightFoot.position.set(0.3, -1.8, 0.2);
            rightFoot.castShadow = true;
            avatar.add(rightFoot);
            
            // Chão
            const floorGeometry = new THREE.PlaneGeometry(20, 20);
            const floorMaterial = new THREE.MeshLambertMaterial({ color: 0xffffff });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.position.y = -2;
            floor.receiveShadow = true;
            scene.add(floor);
            
            // Adicionar avatar à cena
            scene.add(avatar);
            
            // Criar textura da estampa inicial
            createStampTexture();
        }
        
        function createStampTexture() {
            const canvas = document.createElement('canvas');
            canvas.width = 512;
            canvas.height = 512;
            const ctx = canvas.getContext('2d');
            
            // Cor de fundo
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, 512, 512);
            
            // Desenhar padrão baseado no estilo selecionado
            const style = document.getElementById('stampStyle').value;
            const primaryColor = document.getElementById('primaryColor').value;
            const secondaryColor = document.getElementById('secondaryColor').value;
            const intensity = parseFloat(document.getElementById('stampIntensity').value);
            
            ctx.globalAlpha = intensity;
            
            switch(style) {
                case 'geometrico':
                    drawGeometricPattern(ctx, primaryColor, secondaryColor);
                    break;
                case 'organico':
                    drawOrganicPattern(ctx, primaryColor, secondaryColor);
                    break;
                case 'abstrato':
                    drawAbstractPattern(ctx, primaryColor, secondaryColor);
                    break;
                case 'figurativo':
                    drawFigurativePattern(ctx, primaryColor, secondaryColor);
                    break;
            }
            
            // Criar textura
            stampTexture = new THREE.CanvasTexture(canvas);
            stampTexture.wrapS = THREE.RepeatWrapping;
            stampTexture.wrapT = THREE.RepeatWrapping;
            stampTexture.repeat.set(2, 2);
            
            // Aplicar textura à camiseta
            stampMaterial.map = stampTexture;
            stampMaterial.needsUpdate = true;
        }
        
        function drawGeometricPattern(ctx, primary, secondary) {
            // Padrão geométrico
            ctx.fillStyle = primary;
            for(let i = 0; i < 8; i++) {
                for(let j = 0; j < 8; j++) {
                    if((i + j) % 2 === 0) {
                        ctx.fillRect(i * 64, j * 64, 64, 64);
                    }
                }
            }
            
            ctx.fillStyle = secondary;
            for(let i = 0; i < 8; i++) {
                for(let j = 0; j < 8; j++) {
                    if((i + j) % 2 === 1) {
                        ctx.beginPath();
                        ctx.arc(i * 64 + 32, j * 64 + 32, 20, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            }
        }
        
        function drawOrganicPattern(ctx, primary, secondary) {
            // Padrão orgânico
            ctx.fillStyle = primary;
            for(let i = 0; i < 6; i++) {
                for(let j = 0; j < 6; j++) {
                    ctx.beginPath();
                    ctx.ellipse(
                        i * 85 + 42, 
                        j * 85 + 42, 
                        30 + Math.random() * 20, 
                        20 + Math.random() * 15, 
                        Math.random() * Math.PI, 
                        0, 
                        Math.PI * 2
                    );
                    ctx.fill();
                }
            }
            
            ctx.fillStyle = secondary;
            for(let i = 0; i < 6; i++) {
                for(let j = 0; j < 6; j++) {
                    ctx.beginPath();
                    ctx.arc(i * 85 + 42, j * 85 + 42, 10 + Math.random() * 10, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        }
        
        function drawAbstractPattern(ctx, primary, secondary) {
            // Padrão abstrato
            ctx.strokeStyle = primary;
            ctx.lineWidth = 8;
            
            for(let i = 0; i < 20; i++) {
                ctx.beginPath();
                ctx.moveTo(Math.random() * 512, Math.random() * 512);
                ctx.quadraticCurveTo(
                    Math.random() * 512, Math.random() * 512,
                    Math.random() * 512, Math.random() * 512
                );
                ctx.stroke();
            }
            
            ctx.fillStyle = secondary;
            for(let i = 0; i < 15; i++) {
                ctx.beginPath();
                ctx.arc(Math.random() * 512, Math.random() * 512, Math.random() * 30 + 10, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function drawFigurativePattern(ctx, primary, secondary) {
            // Padrão figurativo (exemplo: estrelas e corações)
            ctx.fillStyle = primary;
            for(let i = 0; i < 8; i++) {
                for(let j = 0; j < 8; j++) {
                    drawStar(ctx, i * 64 + 32, j * 64 + 32, 15, 5);
                }
            }
            
            ctx.fillStyle = secondary;
            for(let i = 0; i < 6; i++) {
                for(let j = 0; j < 6; j++) {
                    drawHeart(ctx, i * 85 + 42, j * 85 + 42, 12);
                }
            }
        }
        
        function drawStar(ctx, x, y, radius, spikes) {
            ctx.beginPath();
            for(let i = 0; i < spikes * 2; i++) {
                const angle = (i * Math.PI) / spikes;
                const r = i % 2 === 0 ? radius : radius / 2;
                const px = x + Math.cos(angle) * r;
                const py = y + Math.sin(angle) * r;
                if(i === 0) ctx.moveTo(px, py);
                else ctx.lineTo(px, py);
            }
            ctx.closePath();
            ctx.fill();
        }
        
        function drawHeart(ctx, x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y + size / 4);
            ctx.bezierCurveTo(x, y, x - size / 2, y, x - size / 2, y + size / 4);
            ctx.bezierCurveTo(x - size / 2, y + size / 2, x, y + size / 2, x, y + size);
            ctx.bezierCurveTo(x, y + size / 2, x + size / 2, y + size / 2, x + size / 2, y + size / 4);
            ctx.bezierCurveTo(x + size / 2, y, x, y, x, y + size / 4);
            ctx.fill();
        }
        
        function updateStamp() {
            createStampTexture();
        }
        
        function resetAvatar() {
            document.getElementById('stampStyle').value = 'geometrico';
            document.getElementById('primaryColor').value = '#1A237E';
            document.getElementById('secondaryColor').value = '#FF9800';
            document.getElementById('stampIntensity').value = '0.8';
            createStampTexture();
        }
        
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
