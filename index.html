<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EstampAI - Chat com IA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: #1A237E;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 5px;
        }
        
        .main {
            flex: 1;
            display: flex;
            gap: 20px;
            padding: 20px;
        }
        
        .chat-section {
            flex: 1;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .messages {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            overflow-y: auto;
            max-height: 400px;
        }
        
        .message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        
        .user {
            background: #e3f2fd;
            text-align: right;
        }
        
        .ai {
            background: #f3e5f5;
        }
        
        .input-area {
            display: flex;
            gap: 10px;
        }
        
        .input-area textarea {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            resize: vertical;
            min-height: 50px;
        }
        
        .input-area button {
            padding: 10px 20px;
            background: #1A237E;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .input-area button:hover {
            background: #0d47a1;
        }
        
        .results-section {
            flex: 1;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .view-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .view-buttons button {
            padding: 10px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .view-buttons button.active {
            background: #1A237E;
            color: white;
        }
        
        .canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
            position: relative; /* Permite posicionamento absoluto dos elementos filhos */
        }
        
        canvas {
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        
        #estampaIsolada {
            display: none;
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }
        
        #estampaIsolada img {
            max-width: 200px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .download-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        .download-btn:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ü§ñ EstampAI</h1>
        <p>Chat com IA para Cria√ß√£o de Estampas</p>
    </div>
    
    <div class="main">
        <div class="chat-section">
            <div class="messages" id="messages">
                <!-- Mensagens aparecer√£o aqui -->
            </div>
            
            <div class="input-area">
                <textarea id="chatInput" placeholder="Conte-me sobre sua ideia de estampa..."></textarea>
                <div style="display: flex; flex-direction: column; gap: 5px;">
                    <button onclick="sendMessage()">üí¨ Enviar</button>
                    <button onclick="generateStampNow()" style="background: #4CAF50; font-size: 12px;">üé® Gerar Estampa</button>
                </div>
            </div>
        </div>
        
        <div class="results-section">
            <div class="view-buttons">
                <button class="active" onclick="showView('avatar')">üë§ Avatar</button>
                <button onclick="showView('stamp')">üé® Estampa</button>
                <button onclick="carregarSuaImagem()" style="background: #4CAF50; color: white;">üîÑ Carregar Avatar</button>
            </div>
            
            <div class="canvas-container">
                <canvas id="avatarCanvas" width="400" height="500" style="display: block;"></canvas>
                <canvas id="stampCanvas" width="400" height="400" style="display: none;"></canvas>
            </div>
            
            <div id="estampaIsolada" style="display: none; text-align: center; margin-top: 20px; padding: 20px; background: #f5f5f5; border-radius: 10px;">
                <!-- Estampa gerada pela IA aparecer√° aqui -->
            </div>
        </div>
    </div>

    <script>
        // Configura√ß√£o da API
        const API_KEY = 'YOUR_OPENAI_API_KEY_HERE'; // Substitua pela sua API key
        
        // Estado da conversa
        let conversationHistory = [];
        let isGeneratingStamp = false;
        let currentStampPrompt = '';

        // Fun√ß√£o para mostrar diferentes visualiza√ß√µes
        function showView(view) {
            // Remove active de todos os bot√µes
            document.querySelectorAll('.view-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Adiciona active ao bot√£o clicado
            event.target.classList.add('active');
            
            // Mostra/esconde canvas
            if (view === 'avatar') {
                document.getElementById('avatarCanvas').style.display = 'block';
                document.getElementById('stampCanvas').style.display = 'none';
            } else {
                document.getElementById('avatarCanvas').style.display = 'none';
                document.getElementById('stampCanvas').style.display = 'block';
            }
        }

        // Fun√ß√£o para carregar a imagem do avatar
        function carregarSuaImagem() {
            console.log('üñºÔ∏è Carregando sua imagem AVATAR.png...');
            
            const canvas = document.getElementById('avatarCanvas');
            if (!canvas) {
                console.error('‚ùå Canvas n√£o encontrado!');
                return;
            }
            
            const ctx = canvas.getContext('2d');
            if (!ctx) {
                console.error('‚ùå Contexto do canvas n√£o encontrado!');
                return;
            }
            
            // Limpa o canvas primeiro
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Desenha um fundo tempor√°rio
            ctx.fillStyle = '#f0f0f0';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#333';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Carregando avatar...', canvas.width/2, canvas.height/2);
            
            const img = new Image();
            img.onload = function() {
                console.log('‚úÖ Sua imagem carregada com sucesso!');
                console.log('üìè Dimens√µes da imagem:', img.width, 'x', img.height);
                console.log('üìè Dimens√µes do canvas:', canvas.width, 'x', canvas.height);
                
                // Limpa o canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Desenha a imagem
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                console.log('‚úÖ Avatar atualizado com sua imagem!');
            };
            
            img.onerror = function() {
                console.error('‚ùå Erro ao carregar sua imagem');
                console.error('‚ùå URL tentada:', img.src);
                
                // Desenha um placeholder de erro
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#ffebee';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#d32f2f';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Erro ao carregar avatar', canvas.width/2, canvas.height/2 - 20);
                ctx.font = '12px Arial';
                ctx.fillText('Verifique se o arquivo existe', canvas.width/2, canvas.height/2 + 10);
            };
            
            // Define a URL da imagem
            img.src = 'assets/images/AVATAR.png';
            console.log('üîó Tentando carregar:', img.src);
        }

        // Fun√ß√£o para adicionar mensagens
        function addMessage(type, text) {
            const messages = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = text;
            messages.appendChild(messageDiv);
            messages.scrollTop = messages.scrollHeight;
            
            // Adiciona ao hist√≥rico da conversa
            conversationHistory.push({
                role: type === 'user' ? 'user' : 'assistant',
                content: text,
                timestamp: new Date()
            });
        }

        // Fun√ß√£o para chat conversacional com GPT
        async function chatWithAI(userMessage) {
            try {
                // Adiciona mensagem do usu√°rio ao hist√≥rico
                conversationHistory.push({
                    role: 'user',
                    content: userMessage,
                    timestamp: new Date()
                });

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4',
                        messages: [
                            {
                                role: 'system',
                                content: `Voc√™ √© a EstampAI, uma assistente especializada em cria√ß√£o de estampas para camisetas. 

Sua personalidade:
- Criativa e entusiasmada
- Conhece tend√™ncias de moda e streetwear
- Ajuda a refinar ideias de estampas
- Faz perguntas para entender melhor o que o usu√°rio quer
- Sugere melhorias e varia√ß√µes

IMPORTANTE: S√≥ sugira gerar a estampa quando o usu√°rio mencionar elementos espec√≠ficos como:
- Drag√£o, caveira, cruz, fogo, moto, carro, bras√£o, s√≠mbolo, logo, √≠cone
- Ou quando o usu√°rio explicitamente pedir para gerar

Quando o usu√°rio mencionar uma ideia de estampa:
1. Fa√ßa perguntas para entender melhor (estilo, cores, p√∫blico-alvo)
2. Sugira melhorias ou varia√ß√µes
3. S√≥ pergunte se quer gerar quando tiver elementos espec√≠ficos

Exemplos de perguntas:
- "Que estilo voc√™ prefere? Minimalista, realista, cartoon?"
- "Para que p√∫blico? Jovem, adulto, infantil?"
- "Que cores voc√™ imagina?"
- "Alguma refer√™ncia visual?"

Seja conversacional e amig√°vel!`
                            },
                            ...conversationHistory.slice(-10) // √öltimas 10 mensagens para contexto
                        ],
                        max_tokens: 300,
                        temperature: 0.8
                    })
                });

                if (!response.ok) {
                    throw new Error(`Erro da API: ${response.status}`);
                }

                const data = await response.json();
                const aiResponse = data.choices[0].message.content;
                
                // Adiciona resposta da IA ao hist√≥rico
                conversationHistory.push({
                    role: 'assistant',
                    content: aiResponse,
                    timestamp: new Date()
                });

                return aiResponse;

            } catch (error) {
                console.error('‚ùå Erro no chat:', error);
                return 'Desculpe, estou com dificuldades t√©cnicas. Pode tentar novamente?';
            }
        }

        // Fun√ß√£o para detectar inten√ß√£o de gerar estampa
        function shouldGenerateStamp(message) {
            const generateKeywords = [
                'gerar estampa', 'criar estampa', 'fazer estampa', 
                'vamos criar', 'pode gerar', 'quero gerar', 'gerar agora',
                'criar agora', 'fazer agora', 'produzir estampa'
            ];
            
            return generateKeywords.some(keyword => 
                message.toLowerCase().includes(keyword)
            );
        }

        // Fun√ß√£o para extrair prompt da conversa usando contexto inteligente
        async function extractStampPrompt() {
            // Se n√£o h√° hist√≥rico suficiente, usa a √∫ltima mensagem
            if (conversationHistory.length < 2) {
                return conversationHistory[conversationHistory.length - 1]?.content || '';
            }
            
            try {
                // Usa GPT para extrair contexto relevante da conversa
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4',
                        messages: [
                            {
                                role: 'system',
                                content: `Voc√™ √© um especialista em extrair informa√ß√µes relevantes para cria√ß√£o de estampas.

Sua tarefa: Analisar a conversa e extrair APENAS os elementos visuais espec√≠ficos que devem aparecer na estampa.

INSTRU√á√ïES:
1. Identifique elementos visuais espec√≠ficos (objetos, pessoas, animais, s√≠mbolos, etc.)
2. Identifique estilo visual (vintage, minimalista, realista, cartoon, etc.)
3. Identifique cores mencionadas
4. Identifique composi√ß√£o (centralizada, grande, pequena, etc.)
5. IGNORE informa√ß√µes sobre p√∫blico-alvo, marca, neg√≥cio, etc.

FORMATO DE RESPOSTA:
Se houver elementos visuais espec√≠ficos, retorne APENAS uma descri√ß√£o concisa dos elementos visuais.
Se N√ÉO houver elementos visuais espec√≠ficos, retorne "INSUFICIENTE".

EXEMPLOS:
- "drag√£o flamejante em estilo vintage"
- "caveira punk com espinhos em preto e branco"
- "jogador de futebol em est√°dio com bandeiras do Brasil no estilo p√¥ster vintage"
- "INSUFICIENTE" (se s√≥ mencionar "marca", "neg√≥cio", "p√∫blico-alvo", etc.)`
                            },
                            {
                                role: 'user',
                                content: `Analise esta conversa e extraia os elementos visuais para estampa:\n\n${conversationHistory.map(msg => `${msg.role}: ${msg.content}`).join('\n')}`
                            }
                        ],
                        max_tokens: 100,
                        temperature: 0.3
                    })
                });

                if (!response.ok) {
                    throw new Error(`Erro da API: ${response.status}`);
                }

                const data = await response.json();
                const extractedPrompt = data.choices[0].message.content.trim();
                
                console.log('üß† Contexto extra√≠do:', extractedPrompt);
                
                // Se retornou "INSUFICIENTE", n√£o gera estampa
                if (extractedPrompt === 'INSUFICIENTE') {
                    return null;
                }
                
                return extractedPrompt;

            } catch (error) {
                console.error('‚ùå Erro ao extrair contexto:', error);
                // Fallback para m√©todo anterior
                const userMessages = conversationHistory
                    .filter(msg => msg.role === 'user')
                    .map(msg => msg.content)
                    .join(' ');
                return userMessages;
            }
        }

        // Fun√ß√£o para criar prompt inteligente
        function criarPromptInteligente(descricaoUsuario) {
            // Se a descri√ß√£o √© null ou vazia, retorna erro
            if (!descricaoUsuario || descricaoUsuario === 'null') {
                throw new Error('Descri√ß√£o da estampa n√£o encontrada');
            }
            
            return `Ilustra√ß√£o isolada de ${descricaoUsuario}

Fundo: PRETO S√ìLIDO

Especifica√ß√µes t√©cnicas:
- Formato: Quadrado 1024x1024px
- Resolu√ß√£o: Alta qualidade (HD)
- Estilo: Moderno, din√¢mico e vers√°til
- Cores: Vibrantes e contrastantes
- Composi√ß√£o: Centralizada e equilibrada

N√ÉO incluir:
- Camiseta, roupa, mockup, produto ou manequim
- Fundo colorido ou padr√£o
- Texto ou tipografia
- Bordas ou molduras
- Elementos de design de produto

RESULTADO: Ilustra√ß√£o isolada, fundo preto s√≥lido, alta qualidade, perfeita para estampa de camiseta.`;
        }

        // Fun√ß√£o para gerar estampa com IA
        async function gerarEstampaComIA(promptUsuario) {
            console.log('üöÄ Iniciando gera√ß√£o com IA...');
            console.log('üìù Prompt recebido:', promptUsuario);
            
            // Verifica se o prompt √© v√°lido
            if (!promptUsuario || promptUsuario === 'null') {
                throw new Error('Prompt inv√°lido para gera√ß√£o de estampa');
            }
            
            const prompt = criarPromptInteligente(promptUsuario);
            console.log('üìù Prompt criado:', prompt);
            
            try {
                const response = await fetch('https://api.openai.com/v1/images/generations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'dall-e-3',
                        prompt: prompt,
                        n: 1,
                        size: '1024x1024',
                        response_format: 'url'
                    })
                });
                
                console.log('üì° Resposta da API:', response.status);
                
                if (!response.ok) {
                    throw new Error(`Erro da API: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ Dados recebidos:', data);
                
                if (data.data && data.data[0] && data.data[0].url) {
                    const imageUrl = data.data[0].url;
                    console.log('üé® URL da imagem:', imageUrl);
                    return imageUrl;
                } else {
                    throw new Error('URL da imagem n√£o encontrada na resposta');
                }
                
            } catch (error) {
                console.error('‚ùå Erro ao gerar estampa:', error);
                throw error;
            }
        }

        // Fun√ß√£o para aplicar estampa no avatar (usando mesma l√≥gica do visualizador)
        function aplicarEstampaIA(urlImagem) {
            console.log('üéØ Aplicando estampa IA:', urlImagem);
            
            // Usa a mesma l√≥gica do visualizador de estampas - cria elemento img
            const avatarContainer = document.querySelector('.canvas-container');
            
            // Remove estampa anterior se existir
            const existingStamp = document.getElementById('avatarStamp');
            if (existingStamp) {
                existingStamp.remove();
            }
            
            // Cria elemento img para a estampa (mesma l√≥gica do visualizador)
            const stampImg = document.createElement('img');
            stampImg.id = 'avatarStamp';
            stampImg.src = urlImagem;
            stampImg.alt = 'Estampa gerada';
            stampImg.style.cssText = `
                position: absolute;
                top: 20%;
                left: 50%;
                transform: translateX(-50%);
                width: 120px;
                height: 120px;
                z-index: 10;
                border-radius: 5px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            `;
            
            stampImg.onload = function() {
                console.log('‚úÖ Estampa carregada e exibida no avatar!');
                console.log('üìè Dimens√µes da estampa:', stampImg.width, 'x', stampImg.height);
            };
            
            stampImg.onerror = function() {
                console.error('‚ùå Erro ao carregar estampa no avatar');
                // Remove a imagem com erro
                stampImg.remove();
                
                // Cria fallback visual
                const fallback = document.createElement('div');
                fallback.id = 'avatarStampFallback';
                fallback.style.cssText = `
                    position: absolute;
                    top: 20%;
                    left: 50%;
                    transform: translateX(-50%);
                    width: 120px;
                    height: 120px;
                    background: #ff5722;
                    border-radius: 5px;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    color: white;
                    font-weight: bold;
                    font-size: 12px;
                    text-align: center;
                    z-index: 10;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                `;
                fallback.innerHTML = 'ESTAMP<br>GERADA';
                avatarContainer.appendChild(fallback);
                
                console.log('‚úÖ Fallback visual aplicado no avatar');
            };
            
            // Adiciona a estampa ao container
            avatarContainer.appendChild(stampImg);
            console.log('üîó Estampa adicionada ao avatar');
            
            // Tamb√©m desenha no canvas de estampa (que funciona)
            const stampCanvas = document.getElementById('stampCanvas');
            const stampCtx = stampCanvas.getContext('2d');
            const canvasImg = new Image();
            canvasImg.onload = function() {
                stampCtx.clearRect(0, 0, stampCanvas.width, stampCanvas.height);
                stampCtx.drawImage(canvasImg, 0, 0, stampCanvas.width, stampCanvas.height);
                console.log('‚úÖ Estampa tamb√©m aplicada no canvas de estampa!');
            };
            canvasImg.src = urlImagem;
        }

        // Fun√ß√£o para mostrar estampa isolada
        function mostrarEstampaIsolada(urlImagem) {
            const estampaDiv = document.getElementById('estampaIsolada');
            estampaDiv.innerHTML = `
                <h3>üé® Sua Estampa Gerada</h3>
                <img src="${urlImagem}" alt="Estampa gerada" style="max-width: 300px; border-radius: 10px; margin: 10px 0;">
                <br>
                <button class="download-btn" onclick="downloadImage('${urlImagem}', 'estampa.png')">üì• Baixar Estampa</button>
            `;
            estampaDiv.style.display = 'block';
        }

        // Fun√ß√£o para baixar imagem
        function downloadImage(url, filename) {
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
        }

        // Fun√ß√£o para gerar estampa imediatamente
        async function generateStampNow() {
            if (isGeneratingStamp) return;
            
            const prompt = await extractStampPrompt();
            if (!prompt) {
                addMessage('ai', 'Preciso de mais detalhes! Me conte sobre o que voc√™ quer na estampa: drag√£o, caveira, cruz, s√≠mbolo, logo, etc. üòä');
                return;
            }
            
            isGeneratingStamp = true;
            addMessage('ai', 'üé® Gerando sua estampa agora...');
            
            try {
                // Gera estampa com IA
                const imageUrl = await gerarEstampaComIA(prompt);
                
                // Aplica no avatar
                aplicarEstampaIA(imageUrl);
                
                // Mostra estampa isolada
                mostrarEstampaIsolada(imageUrl);
                
                addMessage('ai', '‚ú® Pronto! Sua estampa foi criada!');
                isGeneratingStamp = false;
                
            } catch (error) {
                console.error('‚ùå Erro:', error);
                addMessage('ai', 'Desculpe, n√£o consegui gerar sua estampa. Tente novamente!');
                isGeneratingStamp = false;
            }
        }

        // Fun√ß√£o para enviar mensagem
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message || isGeneratingStamp) return;
            
            // Adiciona mensagem do usu√°rio
            addMessage('user', message);
            input.value = '';
            
            // Mostra indicador de digita√ß√£o
            addMessage('ai', 'ü§î Pensando...');
            
            try {
                // Chat conversacional com IA
                const aiResponse = await chatWithAI(message);
                
                // Remove a mensagem "Pensando..." e adiciona a resposta real
                const messages = document.getElementById('messages');
                messages.removeChild(messages.lastChild);
                addMessage('ai', aiResponse);
                
                // Verifica se deve gerar estampa
                if (shouldGenerateStamp(message) || shouldGenerateStamp(aiResponse)) {
                    isGeneratingStamp = true;
                    addMessage('ai', 'üé® Perfeito! Vou gerar sua estampa agora...');
                    
                    // Extrai o prompt da conversa
                    currentStampPrompt = await extractStampPrompt();
                    console.log('üìù Prompt extra√≠do da conversa:', currentStampPrompt);
                    
                    // Verifica se o prompt √© v√°lido
                    if (!currentStampPrompt || currentStampPrompt === 'null') {
                        addMessage('ai', 'Ops! Preciso de mais detalhes espec√≠ficos. Me conte sobre o que voc√™ quer na estampa: jogador, est√°dio, bandeira, etc.');
                        isGeneratingStamp = false;
                        return;
                    }
                    
                    // Gera estampa com IA
                    const imageUrl = await gerarEstampaComIA(currentStampPrompt);
                    
                    // Aplica no avatar
                    aplicarEstampaIA(imageUrl);
                    
                    // Mostra estampa isolada
                    mostrarEstampaIsolada(imageUrl);
                    
                    addMessage('ai', '‚ú® Pronto! Sua estampa foi criada! Veja como ficou no avatar e baixe se quiser!');
                    isGeneratingStamp = false;
                }
                
            } catch (error) {
                console.error('‚ùå Erro:', error);
                // Remove a mensagem "Pensando..." se houver erro
                const messages = document.getElementById('messages');
                if (messages.lastChild && messages.lastChild.textContent === 'ü§î Pensando...') {
                    messages.removeChild(messages.lastChild);
                }
                addMessage('ai', 'Desculpe, estou com dificuldades t√©cnicas. Pode tentar novamente?');
            }
        }

        // Inicializa√ß√£o
        window.onload = function() {
            console.log('üöÄ EstampAI iniciando...');
            
            // Mostra mensagem de boas-vindas
            addMessage('ai', 'Ol√°! üëã Sou a EstampAI, sua assistente para cria√ß√£o de estampas! \n\nConte-me sobre sua ideia: que tipo de estampa voc√™ gostaria de criar? Pode ser qualquer coisa - desde s√≠mbolos simples at√© ilustra√ß√µes complexas!');
            
            // Carrega a imagem do avatar
            setTimeout(() => {
                console.log('‚è∞ Carregando avatar...');
                carregarSuaImagem();
            }, 1000);
            
            // Adiciona suporte para Enter no textarea
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        };
    </script>
</body>
</html>